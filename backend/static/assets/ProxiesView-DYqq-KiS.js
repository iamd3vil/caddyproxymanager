import{d as S,r as m,i as U,c as n,e as u,b as e,t as i,j as b,F as _,k,w as A,f as c,v as M,l as y,m as x,o as a,p as V}from"./index-CRIMLnw7.js";const q={key:0,class:"alert alert-error mb-4"},L={class:"mb-8 flex justify-between items-center"},$=["disabled"],j={key:0,class:"loading loading-spinner loading-sm"},B={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},E={key:1,class:"text-center py-16"},H={key:2,class:"text-center py-16"},I={key:3,class:"grid gap-4"},F={class:"card-body"},R={class:"flex justify-between items-start"},z={class:"flex-1"},O={class:"card-title text-primary mb-3"},G={class:"flex items-center gap-3 mb-3 p-3 bg-base-200 rounded-lg"},W={class:"text-sm"},Y={class:"text-primary font-mono"},Z={class:"text-sm"},J={class:"text-accent font-mono"},K={class:"flex gap-2 flex-wrap"},Q={class:"badge badge-secondary"},X={key:0,class:"badge badge-success"},ee={class:"badge badge-outline"},te={class:"card-actions"},se=["onClick","disabled","title"],le={key:4,class:"modal modal-open"},oe={class:"modal-box"},ne={class:"form-control"},ae={class:"form-control mt-4"},re={class:"form-control mt-4"},de={key:0,class:"mt-6 p-4 bg-base-200 rounded-lg"},ie={class:"form-control"},ue={class:"label"},ve={class:"label-text-alt"},ce={key:0,class:"mt-4"},pe={class:"form-control"},me=["value"],be={class:"mt-4"},ge={class:"label"},fe={class:"label-text"},_e=["onUpdate:modelValue","type","required","placeholder"],ke={key:0,class:"alert alert-info mt-2"},ye={class:"modal-action"},xe=["disabled"],we=["disabled"],he={key:0,class:"loading loading-spinner loading-sm"},Me=S({__name:"ProxiesView",setup(Ce){const v=m([]),p=m(!1),r=m(!1),d=m(""),o=m({domain:"",target_url:"",ssl_mode:"auto",challenge_type:"http",dns_provider:"cloudflare",dns_credentials:{}}),g=async()=>{r.value=!0,d.value="";const l=await x.getProxies();l.error?(d.value=l.error,v.value=[]):l.data?v.value=l.data.proxies||[]:v.value=[],r.value=!1},w=async()=>{if(!o.value.domain||!o.value.target_url){d.value="Domain and target URL are required";return}r.value=!0,d.value="";const l=await x.createProxy(o.value);l.error?d.value=l.error:(p.value=!1,o.value={domain:"",target_url:"",ssl_mode:"auto",challenge_type:"http",dns_provider:"cloudflare",dns_credentials:{}},await g()),r.value=!1},D=async l=>{const t=f(l);if(!l.id||l.id.trim()===""){d.value="Cannot delete proxy: Missing proxy ID. This proxy may need to be recreated.";return}if(!confirm(`Are you sure you want to delete proxy for ${t}?`))return;r.value=!0,d.value="";const s=await x.deleteProxy(l.id);s.error?d.value=s.error:await g(),r.value=!1},f=l=>{if(l.domain&&l.domain.trim())return l.domain;try{const t=new URL(l.target_url);return`${t.hostname}:${t.port||(t.protocol==="https:"?"443":"80")}`}catch{return l.target_url}},T=l=>l.ssl_mode&&l.ssl_mode.trim()?l.ssl_mode:l.target_url.startsWith("https:")?"auto":"none",N=l=>{try{return new URL(l.target_url).protocol.replace(":","").toUpperCase()}catch{return"HTTP"}},h=()=>{const l=o.value.dns_provider;o.value.dns_credentials={},l==="cloudflare"?o.value.dns_credentials={api_token:"",email:""}:l==="digitalocean"?o.value.dns_credentials={auth_token:""}:l==="duckdns"&&(o.value.dns_credentials={token:""})},C=[{value:"cloudflare",label:"Cloudflare",fields:[{key:"api_token",label:"API Token",type:"password",required:!0},{key:"email",label:"Email (optional)",type:"email",required:!1}]},{value:"digitalocean",label:"DigitalOcean",fields:[{key:"auth_token",label:"Auth Token",type:"password",required:!0}]},{value:"duckdns",label:"DuckDNS",fields:[{key:"token",label:"Token",type:"password",required:!0}]}];return U(()=>{g(),h()}),(l,t)=>(a(),n("div",null,[d.value?(a(),n("div",q,[t[10]||(t[10]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",null,i(d.value),1),e("button",{class:"btn btn-sm",onClick:t[0]||(t[0]=s=>d.value="")},"✕")])):u("",!0),e("div",L,[t[13]||(t[13]=e("div",null,[e("h1",{class:"text-3xl font-bold text-base-content"},"Proxy Management"),e("p",{class:"text-base-content/70 mt-2"},"Manage your Caddy proxy configurations")],-1)),e("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=s=>p.value=!0),disabled:r.value},[r.value?(a(),n("span",j)):(a(),n("svg",B,t[11]||(t[11]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"},null,-1)]))),t[12]||(t[12]=b(" Add Proxy ",-1))],8,$)]),r.value&&(v.value?.length||0)===0?(a(),n("div",E,t[14]||(t[14]=[e("span",{class:"loading loading-spinner loading-lg"},null,-1),e("p",{class:"text-base-content/70 mt-4"},"Loading proxies...",-1)]))):(v.value?.length||0)===0?(a(),n("div",H,[t[15]||(t[15]=e("div",{class:"mockup-code bg-base-200 mx-auto max-w-lg"},[e("pre",{"data-prefix":"$"},[e("code",null,"caddy reverse-proxy --from example.com --to localhost:3000")])],-1)),t[16]||(t[16]=e("h3",{class:"text-xl font-semibold mt-6 text-base-content"},"No proxies configured",-1)),t[17]||(t[17]=e("p",{class:"text-base-content/70 mt-2"},"Get started by adding your first proxy configuration",-1)),e("button",{class:"btn btn-primary mt-4",onClick:t[2]||(t[2]=s=>p.value=!0)}," Add Your First Proxy ")])):(a(),n("div",I,[(a(!0),n(_,null,k(v.value,s=>(a(),n("div",{key:s.id||s.target_url,class:"card bg-base-100 shadow-xl"},[e("div",F,[e("div",R,[e("div",z,[e("h2",O,i(f(s)),1),e("div",G,[e("div",W,[t[18]||(t[18]=e("div",{class:"font-semibold text-base-content"},"From:",-1)),e("div",Y,i(f(s)),1)]),t[20]||(t[20]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-base-content/50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7l5 5-5 5M6 12h12"})],-1)),e("div",Z,[t[19]||(t[19]=e("div",{class:"font-semibold text-base-content"},"To:",-1)),e("div",J,i(s.target_url),1)])]),e("div",K,[e("div",Q,i(T(s)),1),s.status?(a(),n("div",X,i(s.status),1)):u("",!0),e("div",ee,i(N(s)),1)])]),e("div",te,[e("button",{class:"btn btn-error btn-sm",onClick:P=>D(s),disabled:r.value||!s.id||s.id.trim()==="",title:!s.id||s.id.trim()===""?"Cannot delete: Missing proxy ID":"Delete proxy"},t[21]||(t[21]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),b(" Delete ",-1)]),8,se)])])])]))),128))])),p.value?(a(),n("div",le,[e("div",oe,[t[33]||(t[33]=e("h3",{class:"font-bold text-lg text-base-content"},"Add New Proxy",-1)),e("form",{onSubmit:A(w,["prevent"]),class:"py-4"},[e("div",ne,[t[22]||(t[22]=e("label",{class:"label"},[e("span",{class:"label-text"},"Domain/Subdomain")],-1)),c(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.domain=s),type:"text",placeholder:"example.com",class:"input input-bordered",required:""},null,512),[[M,o.value.domain]])]),e("div",ae,[t[23]||(t[23]=e("label",{class:"label"},[e("span",{class:"label-text"},"Target URL")],-1)),c(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>o.value.target_url=s),type:"text",placeholder:"http://localhost:3000",class:"input input-bordered",required:""},null,512),[[M,o.value.target_url]])]),e("div",re,[t[25]||(t[25]=e("label",{class:"label"},[e("span",{class:"label-text"},"SSL Certificate")],-1)),c(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>o.value.ssl_mode=s),class:"select select-bordered"},t[24]||(t[24]=[e("option",{value:"auto"},"Auto (Let's Encrypt)",-1),e("option",{value:"custom"},"Custom Certificate",-1),e("option",{value:"none"},"None (HTTP only)",-1)]),512),[[y,o.value.ssl_mode]])]),o.value.ssl_mode==="auto"?(a(),n("div",de,[t[31]||(t[31]=e("h4",{class:"font-semibold text-base-content mb-4"},"ACME Challenge Configuration",-1)),e("div",ie,[t[27]||(t[27]=e("label",{class:"label"},[e("span",{class:"label-text"},"Challenge Type")],-1)),c(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>o.value.challenge_type=s),class:"select select-bordered"},t[26]||(t[26]=[e("option",{value:"http"},"HTTP-01 Challenge",-1),e("option",{value:"dns"},"DNS-01 Challenge",-1)]),512),[[y,o.value.challenge_type]]),e("div",ue,[e("span",ve,i(o.value.challenge_type==="http"?"Uses HTTP validation (port 80 must be accessible)":"Uses DNS validation (works behind firewalls)"),1)])]),o.value.challenge_type==="dns"?(a(),n("div",ce,[e("div",pe,[t[28]||(t[28]=e("label",{class:"label"},[e("span",{class:"label-text"},"DNS Provider")],-1)),c(e("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>o.value.dns_provider=s),onChange:t[8]||(t[8]=s=>h()),class:"select select-bordered"},[(a(),n(_,null,k(C,s=>e("option",{key:s.value,value:s.value},i(s.label),9,me)),64))],544),[[y,o.value.dns_provider]])]),e("div",be,[t[30]||(t[30]=e("h5",{class:"font-medium text-base-content mb-2"},"DNS Provider Credentials",-1)),(a(!0),n(_,null,k(C.find(s=>s.value===o.value.dns_provider)?.fields,s=>(a(),n("div",{key:s.key,class:"form-control mt-2"},[e("label",ge,[e("span",fe,i(s.label),1)]),c(e("input",{"onUpdate:modelValue":P=>o.value.dns_credentials[s.key]=P,type:s.type,class:"input input-bordered input-sm",required:s.required&&o.value.challenge_type==="dns",placeholder:s.type==="password"?"••••••••••••••••":""},null,8,_e),[[V,o.value.dns_credentials[s.key]]])]))),128)),o.value.dns_provider==="cloudflare"?(a(),n("div",ke,t[29]||(t[29]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"stroke-current shrink-0 w-6 h-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),e("div",{class:"text-xs"},[e("p",null,[e("strong",null,"API Token:"),b(" Create a token with Zone:DNS:Edit permissions")]),e("p",null,[e("strong",null,"Email:"),b(" Only needed for legacy API key authentication")])],-1)]))):u("",!0)])])):u("",!0)])):u("",!0)],32),e("div",ye,[e("button",{class:"btn",onClick:t[9]||(t[9]=s=>p.value=!1),disabled:r.value},"Cancel",8,xe),e("button",{class:"btn btn-primary",onClick:w,disabled:r.value},[r.value?(a(),n("span",he)):u("",!0),t[32]||(t[32]=b(" Add Proxy ",-1))],8,we)])])])):u("",!0)]))}});export{Me as default};
